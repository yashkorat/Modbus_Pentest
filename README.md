# MODBUS Traffic Capture and Injection Tool

This Python script allows you to capture MODBUS traffic, save it to a file, replay the captured traffic, and inject custom MODBUS packets.

## Requirements

- Python 3.x
- `tcpdump` for capturing MODBUS traffic
- `tcpreplay` for replaying captured traffic
- `sendip` for injecting custom packets

## Installation

1. **Install Python 3.x**:
   - Ensure you have Python 3.x installed on your system.

2. **Install required tools**:
   ```bash
   sudo apt-get update
   sudo apt-get install tcpdump tcpreplay sendip

## Usage
Run the script with the desired parameters using the command line:

```bash
python3 modbus_proxy.py --interface <interface> --capture-file <capture_file> --capture-duration <capture_duration> --src-ip <src_ip> --dest-ip <dest_ip> --src-port <src_port> --dest-port <dest_port> --payload <payload>
```
Example

To capture traffic for 60 seconds, save it to modbus_capture.pcap, replay it, and inject a custom packet from source IP 192.168.1.1 to destination IP 192.168.1.2 on port 502 with the payload DEADBEEF:

```bash
python3 modbus_proxy.py --interface eth0 --capture-file modbus_capture.pcap --capture-duration 60 --src-ip 192.168.1.1 --dest-ip 192.168.1.2 --src-port 502 --dest-port 502 --payload DEADBEEF
Command-Line Arguments
--interface: The interface to use for capturing and injecting packets (e.g., eth0).
--capture-file: The file name where the captured traffic will be saved (e.g., modbus_capture.pcap).
--capture-duration: The duration for capturing traffic in seconds (e.g., 60).
--src-ip: The source IP address for the custom packet (e.g., 192.168.1.1).
--dest-ip: The destination IP address for the custom packet (e.g., 192.168.1.2).
--src-port: The source port for the custom packet (e.g., 502).
--dest-port: The destination port for the custom packet (e.g., 502).
--payload: The payload to inject (hex string, e.g., DEADBEEF).
```


```vbnet

usage: modbus_proxy.py [-h] --interface INTERFACE --capture-file CAPTURE_FILE --capture-duration CAPTURE_DURATION --src-ip SRC_IP --dest-ip DEST_IP --src-port SRC_PORT --dest-port DEST_PORT --payload PAYLOAD

MODBUS Traffic Capture and Injection Tool

optional arguments:
  -h, --help            show this help message and exit
  --interface INTERFACE The interface to use (e.g., 'eth0')
  --capture-file CAPTURE_FILE
                        The file to save the capture to
  --capture-duration CAPTURE_DURATION
                        The duration to capture traffic (in seconds)
  --src-ip SRC_IP       The source IP address for the custom packet
  --dest-ip DEST_IP     The destination IP address for the custom packet
  --src-port SRC_PORT   The source port for the custom packet
  --dest-port DEST_PORT The destination port for the custom packet
  --payload PAYLOAD     The payload to inject (hex string)
```
